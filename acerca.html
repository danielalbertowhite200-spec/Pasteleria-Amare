<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>AMARE - Acerca de Nosotros</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free Website Template" name="keywords">
    <meta content="Free Website Template" name="description">

    <link href="img/favicon.ico" rel="icon">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"> 

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

    <link href="css/style.min.css" rel="stylesheet">
    
    <style>
        .auth-container { max-width: 450px; margin: 0 auto; padding: 0; }
        .auth-container h2 { text-align: center; margin-bottom: 10px; }
        .auth-container p { text-align: center; color: #666; margin-bottom: 30px; }
        .auth-form-group { margin-bottom: 20px; }
        .auth-form-group input { width: 100%; height: 50px; padding: 10px 15px; border: 1px solid #ddd; border-radius: 5px; }
        .auth-button { width: 100%; padding: 15px; font-size: 1.1em; font-weight: bold; color: #fff; background-color: #8B4513; border: none; border-radius: 5px; cursor: pointer; }
        .auth-toggle-link { text-align: center; margin-top: 25px; }
        .auth-toggle-link a { color: #DA9F5B; font-weight: bold; cursor: pointer; }
        #register-form-modal { display: none; }
    </style>
</head>

<body>
    <div class="container-fluid p-0 nav-bar">
        <nav class="navbar navbar-expand-lg bg-none navbar-dark py-3">
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                <div class="navbar-nav ml-auto p-4">
                    <a href="index.html" class="nav-item nav-link">Inicio</a> 
                    <a href="menu.html" class="nav-item nav-link">Menu</a>
                    
                    <a href="#" id="login-link" class="nav-item nav-link" data-toggle="modal" data-target="#loginRegisterModal">
                        <i class="fas fa-user" style="font-size: 1.1em; margin-right: 5px;"></i>
                        Iniciar Sesión
                    </a>
                    <div class="nav-item dropdown" id="user-dropdown" style="display: none;">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
                            <i class="fas fa-user" style="font-size: 1.1em; margin-right: 5px;"></i>
                            <span id="user-name-display">Usuario</span>
                        </a>
                        <div class="dropdown-menu text-capitalize">
                            <a href="cuenta.html" class="dropdown-item">Mi Cuenta / Perfil</a>
                            <a href="pago.html" class="dropdown-item">Mi Carrito</a>
                            <a href="index.html" class="dropdown-item">Volver al Inicio</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" onclick="logout()">Cerrar Sesión</a>
                        </div>
                    </div>
                    
                    <a href="pago.html" class="nav-item nav-link">
                        <i class="fas fa-shopping-cart" style="font-size: 1.1em;"></i>
                        <span id="cart-counter-span" style="font-size: 0.8em; font-weight: bold; color: #DA9F5B; vertical-align: top;">(0)</span>
                    </a>
                </div>
            </div>
        </nav>
    </div>
    <div class="container-fluid page-header mb-5 position-relative overlay-bottom">
        <div class="d-flex flex-column align-items-center justify-content-center pt-0 pt-lg-5" style="min-height: 400px">
            <h1 class="display-4 mb-3 mt-0 mt-lg-5 text-white text-uppercase">Acerca de Nosotros</h1>
            <div class="d-inline-flex mb-lg-5">
                <p class="m-0 text-white"><a class="text-white" href="index.html">Inicio</a></p>
                <p class="m-0 text-white px-2">/</p>
                <p class="m-0 text-white">Acerca de</p>
            </div>
        </div>
    </div>
    <div class="container-fluid py-5">
        <div class="container">
            <div class="section-title">
                <h4 class="text-primary text-uppercase" style="letter-spacing: 5px;">SOBRE NOSOTROS</h4>
                <h1 class="display-4">SIRVIENDO DESDE 1950</h1>
            </div>
            <div class="row">
                <div class="col-lg-4 py-0 py-lg-5 px-3">
                    <h1 class="mb-3">Nuestra Historia</h1>
                    <h5 class="mb-3">Un legado de amor y sabor horneado en cada pastel.</h5>
                    <p>La historia de Pastelería Amare comienza en 1950, en la pequeña cocina de nuestra fundadora. Con recetas familiares secretas y una pasión por los ingredientes frescos, lo que empezó como un sueño dulce se convirtió en una tradición. "Amare" (amor) es el ingrediente principal que hemos pasado de generación en generación, sirviendo con orgullo a nuestra comunidad por más de 70 años.</p>
                    <a href="menu.html" class="btn btn-secondary font-weight-bold py-2 px-4 mt-2">Ordenar Ahora</a>
                </div>
                <div class="col-lg-4 d-flex align-items-center justify-content-center">
                    <img class="img-fluid rounded" src="img/img2.webp" style="max-height: 500px; object-fit: cover;" alt="Pastel">
                </div>
                <div class="col-lg-4 py-0 py-lg-5 px-3">
                    <h1 class="mb-3">Nuestra Visión</h1>
                    <p>Nuestra visión es honrar ese legado, combinando la calidez de la repostería tradicional con la innovación de sabores modernos. Aspiramos a seguir siendo parte de los momentos más especiales de tu familia.</p>
                    <h5 class="mb-3"><i class="fa fa-check text-primary mr-3"></i>Productos frescos</h5>
                    <h5 class="mb-3"><i class="fa fa-check text-primary mr-3"></i>Elaboración artesanal</h5>
                    <h5 class="mb-3"><i class="fa fa-check text-primary mr-3"></i>Entrega a domicilio</h5>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid footer text-white mt-5 pt-5 px-0 position-relative overlay-top">
        <div class="row mx-0 pt-5 px-sm-3 px-lg-5 mt-4 justify-content-between"> 
            <div class="col-lg-3 col-md-6 mb-5">
                <h4 class="text-white text-uppercase mb-4" style="letter-spacing: 3px;">Contactanos</h4>
                <p><i class="fa fa-map-marker-alt mr-2"></i>Del Tecnológico 420, Corredor Industrial la Ciénega, 72220 Heroica Puebla de Zaragoza, Pue., Mexico</p>
                <p><i class="fa fa-phone-alt mr-2"></i>+52 2211562756</p>
                <p class="m-0"><i class="fa fa-envelope mr-2"></i>i21220655.19@puebla.tecnm.mx</p>
            </div>
            <div class="col-lg-3 col-md-6 mb-5 text-center mx-auto">
                <h4 class="text-white text-uppercase mb-4" style="letter-spacing: 3px;">
                    <a href="acerca.html" class="text-white" style="text-decoration: none;">Acerca de nosotros</a>
                </h4>
            </div>
            <div class="col-lg-3 col-md-6 mb-5 text-right ml-auto">
                <h4 class="text-white text-uppercase mb-4" style="letter-spacing: 3px;">Horarios</h4>
                <div>
                    <h6 class="text-white text-uppercase">Lunes - Viernes</h6>
                    <p>8.00 AM - 8.00 PM</p>
                    <h6 class="text-white text-uppercase">Sabado - Domingo</h6>
                    <p>2.00 PM - 8.00 PM</p>
                </div>
            </div>
        </div>
        <div class="container-fluid text-center text-white border-top mt-4 py-4 px-sm-3 px-md-5" style="border-color: rgba(256, 256, 256, .1) !important;">
            <p class="mb-2 text-white">Copyright &copy; <a class="font-weight-bold" href="#">Domain</a>. All Rights Reserved.</a></p>
            <p class="m-0 text-white">Designed by <a class="font-weight-bold" href="https://htmlcodex.com">HTML Codex</a></p>
        </div>
    </div>
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <style>
        /* ... (CSS del Modal) ... */
        .auth-container { max-width: 450px; margin: 0 auto; padding: 0; }
        .auth-container h2 { text-align: center; margin-bottom: 10px; }
        .auth-container p { text-align: center; color: #666; margin-bottom: 30px; }
        .auth-form-group { margin-bottom: 20px; }
        .auth-form-group input { width: 100%; height: 50px; padding: 10px 15px; border: 1px solid #ddd; border-radius: 5px; }
        .auth-button { width: 100%; padding: 15px; font-size: 1.1em; font-weight: bold; color: #fff; background-color: #8B4513; border: none; border-radius: 5px; cursor: pointer; }
        .auth-toggle-link { text-align: center; margin-top: 25px; }
        .auth-toggle-link a { color: #DA9F5B; font-weight: bold; cursor: pointer; }
        #register-form-modal { display: none; }
    </style>
    <div class="modal fade" id="loginRegisterModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body" style="padding: 40px;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; top: 15px; right: 20px;"><span aria-hidden="true">&times;</span></button>
                    <div id="login-form-modal" class="auth-container">
                        <form onsubmit="handleLogin(event)">
                            <h2>Conectarme a mi cuenta</h2>
                            <p>Ingresa tu e-mail y contraseña:</p>
                            <div class="auth-form-group"><input type="email" id="login-email" placeholder="Email" required></div>
                            <div class="auth-form-group"><input type="password" id="login-password" placeholder="Contraseña" required></div>
                            <button type="submit" class="auth-button">ENTRAR</button>
                            <div class="auth-toggle-link">¿Nuevo cliente? <a onclick="showRegisterFormModal()">Crear cuenta</a></div>
                        </form>
                    </div>
                    <div id="register-form-modal" class="auth-container">
                        <form onsubmit="handleRegister(event)">
                            <h2>Crear mi cuenta</h2>
                            <p>Por favor completa la siguiente información:</p>
                            <div class="auth-form-group"><input type="text" id="register-name" placeholder="Nombre" required></div>
                            <div class="auth-form-group"><input type="text" id="register-lastname" placeholder="Apellidos" required></div>
                            <div class="auth-form-group"><input type="email" id="register-email" placeholder="Email" required></div>
                            <div class="auth-form-group"><input type="password" id="register-password" placeholder="Contraseña" required></div>
                            <small style="display: block; text-align: center; margin-bottom: 20px; color: #777;">
                                Al continuar acepto los <a href="#" style="color: #DA9F5B;">Términos, Condiciones</a> y <a href="#" style="color: #DA9F5B;">Aviso de Privacidad</a>.
                            </small>
                            <button type="submit" class="auth-button">CREAR MI CUENTA</button>
                            <div class="auth-toggle-link">¿Ya tienes una cuenta? <a onclick="showLoginFormModal()">Entrar aquí</a></div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <script src="mail/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <script src="js/main.js"></script>

    <script>
        // --- 1. CONFIGURACIÓN ---
        const apiKey = 'HokaiA170603'; // <-- ¡Verifica tu clave!
        const registerApiUrl = 'http://localhost/dolibarr/api/index.php/thirdparties';
        
        // --- 2. FUNCIONES DE LÓGICA DE USUARIO ---
        
        function updateCartCounter() {
            let cart = JSON.parse(localStorage.getItem('pasteleriaCart')) || [];
            let count = cart.length; 
            let counterSpan = document.getElementById('cart-counter-span');
            if (counterSpan) {
                if (count > 0) { counterSpan.innerText = `(${count})`; } 
                else { counterSpan.innerText = '(0)'; }
            }
        }
        
        function updateUserStatus() {
            const userName = localStorage.getItem('amare_customer_name');
            const loginLink = document.getElementById('login-link');
            const userDropdown = document.getElementById('user-dropdown');
            const userNameDisplay = document.getElementById('user-name-display');

            if (userName) {
                if (loginLink) loginLink.style.display = 'none';
                if (userDropdown) userDropdown.style.display = 'block';
                if (userNameDisplay) userNameDisplay.innerText = "Hola, " + userName;
            } else {
                if (loginLink) loginLink.style.display = 'block';
                if (userDropdown) userDropdown.style.display = 'none';
            }
        }
        
        function logout() {
            localStorage.removeItem('amare_customer_id');
            localStorage.removeItem('amare_customer_name');
            alert("Has cerrado la sesión.");
            window.location.href = 'index.html';
        }

        // --- 3. CONTROL DEL MODAL ---
        
        const loginFormModal = document.getElementById('login-form-modal');
        const registerFormModal = document.getElementById('register-form-modal');

        function showRegisterFormModal() {
            if(loginFormModal) loginFormModal.style.display = 'none';
            if(registerFormModal) registerFormModal.style.display = 'block';
        }
        function showLoginFormModal() {
            if(registerFormModal) registerFormModal.style.display = 'none';
            if(loginFormModal) loginFormModal.style.display = 'block';
        }
        
        // --- 4. CONEXIÓN A DOLIBARR ---
        
        function handleLogin(event) {
            event.preventDefault(); 
            const email = document.getElementById('login-email').value;
            const adminApiKey = 'HokaiA170603';
            
            const filter = `(t.email = '${email}')`;
            const loginApiUrl = `http://localhost/dolibarr/api/index.php/thirdparties?email=${encodeURIComponent(email)}`;
            
            let statusMessageEl = document.querySelector('#login-form-modal .auth-toggle-link');
            statusMessageEl.innerHTML = '<p style="color: blue;">Buscando cuenta...</p>';

            fetch(loginApiUrl, {
                method: 'GET', headers: {'Accept': 'application/json', 'DOLAPIKEY': adminApiKey }
            })
            .then(response => {
                if (!response.ok) { return response.json().then(err => { throw new Error(err.error.message || 'Error del servidor'); }); }
                return response.json(); 
            })
            .then(data => {
                if (data.length > 0) {
                    const customer = data[0]; 
                    localStorage.setItem('amare_customer_id', customer.id);
                    localStorage.setItem('amare_customer_name', customer.name.split(' ')[0]); 
                    alert('¡Bienvenido de nuevo, ' + customer.name.split(' ')[0] + '!');
                    $('#loginRegisterModal').modal('hide');
                    updateUserStatus(); 
                    window.location.reload(); 
                } else {
                    throw new Error("Email no encontrado. Por favor, crea una cuenta.");
                }
            })
            .catch(error => {
                console.error('Error al iniciar sesión:', error);
                statusMessageEl.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            });
        }
        
        function handleRegister(event) {
            event.preventDefault(); 
            const name = document.getElementById('register-name').value;
            const lastname = document.getElementById('register-lastname').value;
            const email = document.getElementById('register-email').value;
            
            let statusMessageEl = document.querySelector('#register-form-modal .auth-toggle-link');
            statusMessageEl.innerHTML = '<p style="color: blue;">Creando cuenta...</p>';

            const customerData = {
                'name': `${name} ${lastname}`, 'email': email, 'client': '1', 'code_client': '-1'
            };

            fetch(registerApiUrl, {
                method: 'POST',
                headers: {'Content-Type': 'application/json', 'Accept': 'application/json', 'DOLAPIKEY': apiKey },
                body: JSON.stringify(customerData)
            })
            .then(response => {
                if (!response.ok) { return response.json().then(err => { throw new Error(err.error.message); }); }
                return response.json(); 
            })
            .then(newCustomerId => {
                localStorage.setItem('amare_customer_id', newCustomerId);
                localStorage.setItem('amare_customer_name', name);
                alert('¡Bienvenido, ' + name + '! Tu cuenta ha sido creada.');
                $('#loginRegisterModal').modal('hide');
                updateUserStatus(); 
                window.location.reload(); 
            })
            .catch(error => {
                console.error('Error al crear el cliente:', error);
                statusMessageEl.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            });
        }
        
        // --- 5. EJECUCIÓN AL CARGAR LA PÁGINA ---
        document.addEventListener('DOMContentLoaded', function() {
            updateCartCounter();
            updateUserStatus();
        });
    </script>
</body>
</html>